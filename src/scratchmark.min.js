let md=function(){class e extends Array{constructor(){super(),this.byname={}}add(e,t){if(t){let r=this.findIndex((e=>e.name==t));if(-1==r)throw"no parser called "+t;this.splice(r,0,e)}else this.push(e);this.byname[e.name]=e}}let t=new e,r=new e;function n(e){return""==e}function i(e){return e?.startsWith?.(" ")}function s(e,t){let r=[];for(;e.length>0&&t(e[0]);)r.push(e.shift());return r}function l(e){let r=[],i=[];for(;e.length>0;){let a;for(let r of t)if(a=r.parse(e,{parse_blocks:l,parse_inline:c}))break;a?"omit"!=a.name&&(s("textblock"),i.push(a)):n(e[0])?r.length>0?(r.push(e.shift()),s("p")):i.push({name:"text",text:e.shift()}):r.push(e.shift())}return r.length>0&&s("textblock"),i;function s(t){if("p"==t&&e.unshift(r.pop()),0==r.length)return;let n=c(r.join("\n"));"p"==t?i.push({name:t,children:n}):i.push(...n),r=[]}}preprocessors=[],window.blockparsers=t;let a=e=>new RegExp("(?<!\\\\)"+e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),o=e=>e.replaceAll(/\\(?!\\)/g,"");function c(e,t){"string"==typeof e&&(e={text:e,cursor:0}),"string"==typeof t&&(t=a(t));let n,i=[],s={};s.indexOf=t?(e,r)=>{t.lastIndex=r;let n=t.exec(e);return n?n.index:e.length}:e=>e.length;let l=[...r];for(;e.cursor<e.text.length;){let t=s.indexOf(e.text,e.cursor),r=s;for(let n=0;n<l.length;n++){let i=l[n],s=i.indexOf(e.text,e.cursor);-1!=s&&s<t&&(t=s,r=i),-1==s&&(l[n]=void 0)}if(l=l.filter((e=>e)),t>e.cursor&&(i.push({name:"text",text:o(e.text.slice(e.cursor,t))}),e.cursor=t),r==s)break;(n=r.parse(e,c))?i.push(n):i.push({name:"text",text:o(e.text.at(e.cursor++))})}return i.forEach((e=>{e.type="inline"})),i}t.add({name:"header",re:/^#{1,6} /,parse(e,{parse_inline:t}){let r=e[0].match(this.re)?.[0];if(r){let n=e.shift().slice(r.length);return n=n.replace(/#+$/,""),{name:"h"+(r.length-1),children:t(n)}}}}),t.add({name:"blockquote",parse(e,{parse_blocks:t}){let r=s(e,(e=>e.startsWith(">")));if(r.length>0)return r=r.map((e=>e.replace(/^> ?/,""))),{name:"blockquote",children:t(r)}}}),t.add({name:"indented_codeblock",parse(e){let t=s(e,(e=>e.startsWith("    ")));if(t.length>0)return{name:"codeblock",children:t.map((e=>({name:"text",text:e.replace(/^    /,"")})))}}}),t.add({name:"fenced_codeblock",init(){for(let e in h)h[e].init?.()},postprocess(e){for(let t in h)h[t].postprocess?.(e)},parse(e){if(e[0]?.startsWith("```")){let t=e.shift().slice(3),r=s(e,(e=>!e.startsWith("```")));return e.shift(),h[t]?.parse?.(children)||{name:"codeblock",type:t,children:r.map((e=>({name:"text",text:e.replace(/^\\```/,"```")})))}}}});let h={},u={};function f(e){for(let t of e){t.lines[0]=t.lines[0].slice(t.prefix.length);let e=t.prefix.length;for(let r of t.lines.slice(1))n(r)||(e=Math.min(e,r.match(/^ +/)[0].length));let r=new RegExp(`^ {0,${e||1}}`);for(let e=1;e<t.lines.length;e++)t.lines[e]=t.lines[e].replace(r,"")}}function d(e){loose=!1;for(let t of e)if(t.lines.some((e=>n(e)))){loose=!0;break}if(loose)for(let t of e)n(t.lines.at(-1))||t.lines.push("")}function p(e,t){if(e.length>1)for(;n(e.at(-1).lines.at?.(-1));)t.unshift(e.at(-1).lines.pop())}function m(e,t,r){let l=e[0]?.match(t)?.[0];if(l&&r(l)){return{prefix:l,lines:[e.shift(),...s(e,(e=>i(e)||n(e)))]}}}function x(e){let t=a(e);return function(e,r){t.lastIndex=r;let n=t.exec(e);return n?n.index:-1}}function b(e,t,r,n=(e=>e)){let i=a(r);return{name:e,indexOf:x(t),parse(s,l){s.cursor+=t.length;let a=l(s,i);return s.cursor+=r.length,n({name:e,children:a})}}}function g(e,t,r=0,n=!0){t.lastIndex=e.cursor+r;let i=t.exec(e.text)?.index;if(i>=0)return txt=e.text.slice(r+e.cursor,i),e.cursor=i,txt;if(n){let t=e.text.slice(r+e.cursor);return e.cursor=e.text.length,t}return-1}function _(e,t,r,n=(e=>e),i=o){let s=a(r);return{name:e,indexOf:x(t),parse(l){l.cursor+=t.length;let a=g(l,s,0);return l.cursor+=r.length,n({name:e,children:[{name:"text",text:i(a)}]})}}}h.config={init:function(){u={}},parse:function(e){for(let t of e){let[e,r]=t.split(":").map((e=>e.trim()));u[e]=isNaN(+r)?r:+r}return{name:"omit"}}},h.verbatim={parse:function(e){return{name:"verbatim",children:e.map((e=>({name:"text",text:e})))}}},h.omit={parse:function(e){return{name:"omit"}}},t.add({name:"unordered_list",re:/^[+*-] /,parse(e,{parse_blocks:t}){let r,n,i=[],s=e=>!n||e[0]==n;for(;r=m(e,this.re,s);)n||=r.prefix[0],i.push(r);if(i.length>0){return p(i,e),f(i),d(i),i=i.map((e=>e.lines)),i=i.map(t),{name:"ul",attributes:{class:{"*":"star-list","+":"plus-list","-":"minus-list"}[n]},children:i.map((e=>({name:"li",children:e})))}}}}),t.add({name:"ordered_list",re:/^[0-9a-zMCXIV]+[).] /,parse(e,{parse_blocks:t}){let r,n,i=[],s=e=>!n||l(e)==n;for(;r=m(e,this.re,s);)n||=l(r.prefix),i.push(r);if(i.length>0){let r=i[0].prefix.slice(0,-2);return p(i,e),f(i),d(i),i=i.map((e=>e.lines)),i=i.map(t),{name:"ol",attributes:{start:r,type:n.slice(0,-1)},children:i.map((e=>({name:"li",children:e})))}}function l(e){let t,r=e.at(-2);return t="0123456789".includes(e[0])?"1":"IVMXL".includes(e[0])?"I":"ivmxl".includes(e[0])?"i":"ABCDEFGHIJK".includes(e[0])?"A":"a",t+r}}}),t.add({name:"horizontal_rule",parse(e){if(e[0].startsWith("***")||e[0].startsWith("---")||e[0].startsWith("___"))return e.shift(),{name:"hr"}}}),t.add({name:"footnote_def",defs:{},cites:[],init(){this.defs={},this.cites=[]},re:/^\[\^[a-zA-Z0-9]+\]: */,parse(e,{parse_blocks:t}){let r=e[0].match(this.re)?.[0];if(r){let t=r.trim().slice(2,-2),l=[e.shift(),...s(e,(e=>n(e)||i(e)))],a=new RegExp(`^ {0,${r.length}}`);return l=l.map((e=>e.replace(a,""))),l[0]=l[0].slice(r.length),l=l.map((e=>"   "+e)),l[0]="1) "+l[0].slice(3),this.defs[t]=l,{name:"omit"}}},postprocess(e,{parse_blocks:t}){let r=1,n={};for(let e of this.cites)n[e.key]||(n[e.key]=r++),e.key=n[e.key],e.attributes.href=`#footnote_${e.key}`,e.children[0].text=""+e.key;n=Object.fromEntries(Object.entries(n).map((e=>e.toReversed())));let i=[];for(let e=1;e<r;e++)i.push(...this.defs[n[e]]);if(i=t(i),i.length>0){for(let e=0;e<i[0].children.length;e++)i[0].children[e].attributes={id:"footnote_"+(e+1)};e.push({name:"div",attributes:{class:"footnotes"},children:[i]})}}}),t.add({name:"href_def",defs:{},links:[],init(){this.defs={},this.links=[]},re:/^\[[A-Za-z0-9]+\]: */,parse(e){let t=e[0].match(this.re)?.[0];if(t){note=t.slice(1).replace(/\]: *$/,"");let r=e.splice(0,1);return r[0]=r[0].slice(t.length),this.defs[note]=r[0],{name:"omit"}}},postprocess(e){for(let e of this.links)e.attributes.href?e.attributes.href=this.defs[e.attributes.href]||e.attributes.href:e.attributes.src=this.defs[e.attributes.src]||e.attributes.src}}),t.add({name:"html_groups",re:/^<(script|head|!--|!doctype)/i,parse(e,t){let r=e[0].match(this.re)?.[0];if(r){let t;r=r.toLowerCase(),t="\x3c!--"==r?"--\x3e":"<!doctype"==r?">":"</"+r.slice(1)+">";let n=s(e,(e=>-1==e.indexOf(t)));return n.push(e.shift()),{name:"verbatim",children:n}}}}),t.add({name:"html_tags",re:/^<\/?[^>]*>$/,parse(e){if(e[0]?.match(this.re))return{name:"verbatim",children:e.splice(0,1)}}}),t.add({name:"table",parse(e,{parse_inline:t}){let r,n=[],i=0,s=[];for(;r=this.row(e[0],t,i+1);)i++,e.shift(),r.name?n.push(r):s=r;if(0==n.length)return!1;if(s.length>0){for(let e of n)for(let t=0;t<s.length;t++)s[t]&&e.children[t]&&(e.children[t].attributes={style:`text-align:${s[t]}`});for(let e of n[0].children)e.name="th";return{name:"table",children:[{name:"thead",children:[n[0]]},{name:"tbody",children:n.slice(1)}]}}return{name:"table",children:[{name:"tbody",children:n}]}},row(e,t,r){if(e?.startsWith?.("|")){let n=e.split("|").slice(1,-1);return 2==r&&n.every((e=>e&&e.match(/^ *:?-+:? *$/)))?n.map((e=>{let t=e.match(/^ *:-+/),r=e.match(/-+: *$/);return t&&r?"center":t?"left":r?"right":""})):{name:"tr",children:n.map((e=>({name:"td",children:t(e)})))}}}}),r.add(b("strong","**","**")),r.add(b("em","*","*")),r.add(b("strong","__","__")),r.add(b("em","_","_")),r.add(b("sup","^","^")),r.add(b("sub","~","~")),r.add(_("code","`","`")),r.add(_("footnote_cite","[^","]",(({name:e,children:r})=>{let n=t.byname.footnote_def,i={name:"sup",children:[{name:"a",key:o(r[0].text),attributes:{},children:r}]};return n.cites.push(i.children[0]),i})));let k=a(")"),y=a("](");function $(e){if(!e)return"";let t=[];for(let r in e)t.push(`${r}="${e[r]}"`);return" "+t.join(" ")}function j(e){let t={">":"&gt;","<":"&lt;","&":"&amp;"};return e.replaceAll(/<|&|>/g,(e=>t[e]))}r.add({name:"a",indexOf:x("["),parse(e,r){let n=e.cursor;e.cursor++;let i=r(e,y);if(e.cursor==e.length)return e.cursor=n,!1;let s=g(e,k,2,!1);if(-1==s)return e.cursor=n,!1;e.cursor++,s=o(s);let l={name:"a",children:i,attributes:{href:s}};return 0==l.children.length&&l.children.push({name:"text",text:s}),t.byname.href_def.links.push(l),l}}),r.add({name:"img",indexOf:x("!["),parse(e){let r=e.cursor;if(e.cursor+=2,alt=g(e,y,0,!1),-1==alt)return e.cursor=r,!1;let n=g(e,k,2,!1);if(-1==n)return e.cursor=r,!1;e.cursor++,n=o(n),alt=o(alt);let i={name:"img",attributes:{src:n,alt:alt}};return t.byname.href_def.links.push(i),i}});let w={};function A(e,t=""){if(Array.isArray(e)){let r="";for(let n of e)r+=A(n,t);return r}return"inline"==e.type?W(e,t)+"\n":w[e.name]?w[e.name](e,t):e.children?[t+`<${e.name}${$(e.attributes)}>\n`,A(e.children,t+"    "),t+`</${e.name}>\n`].join(""):[t+`<${e.name}${$(e.attributes)}>\n`,t+`</${e.name}>\n`].join("")}function W(e,t=""){if(Array.isArray(e)){let r="";for(let t of e)r+=W(t);return""!=t&&(r=r.split("\n").map((e=>t+e)).join("\n")),r}return w[e.name]?w[e.name](e,t):t+`<${e.name}${$(e.attributes)}>`+W(e.children)+`</${e.name}>`}return w.text=function(e,t){let r=e.text.split("\n").map((e=>t+e)).join("\n");return r.endsWith("\n")||"inline"==e.type||(r+="\n"),r},w.h1=w.h2=w.h3=w.h4=w.h5=w.h6=w.p=function(e,t){return[t+`<${e.name}${$(e.attributes)}>\n`,W(e.children,t+"    ")+"\n",t+`</${e.name}>\n`].join("")},w.codeblock=function(e,t){return[t+`<pre> <code${$(e.attributes)}>\n`,e.children.map((e=>j(e.text))).join("\n")+"\n",t+"</code> </pre>\n"].join("")},w.hr=function(e,t){return t+"<hr>\n"},w.verbatim=function(e,t){return e.children.join("\n")+"\n"},w.omit=()=>"",w.img=function(e,t){return`<${e.name}${$(e.attributes)}>`},w.code=function(e,t){return t+`<code${$(e.attributes)}>`+e.children.map((e=>j(e.text))).join("")+"</code>"},{scratchmark:function(e,n){let i=[(e=e.replace("\t","    ").split(/\r?\n/).map((e=>e.trimRight()))).shift()];for(let t of e)i.at(-1).endsWith("\\")?i.push(i.pop().slice(0,-1)+t):i.push(t);e=i.map((e=>e.trimRight()));for(let e of t)e?.init?.();for(let e of r)e?.init?.();for(let t of preprocessors)t(e);let s=l(e);for(let e of r)e?.postprocess?.(s,c);for(let e of t)e?.postprocess?.(s,{parse_blocks:l,parse_inline:c});return(n||A)(s)},preprocessors:preprocessors,blockparsers:t,inlineparsers:r,grablines:s,blankline:n,indented:i,delimited:b,capture:_,dedent:f,html_printer:A,printers:w}}();
